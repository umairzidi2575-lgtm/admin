<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Instant Finance â€” Admin Dashboard</title>
<style>
  :root{--accent:#2563eb;--green:#10b981;--red:#ef4444;--muted:#6b7280;--bg:#f4f6fb;}
  body{font-family:Inter, Arial,sans-serif;margin:0;padding:12px;background:var(--bg);color:#111}
  h1,h2,h3{margin:4px 0}
  .wrap{max-width:480px;margin:0 auto}
  .card{background:#fff;border-radius:12px;padding:12px;margin-bottom:12px;box-shadow:0 6px 20px rgba(0,0,0,0.05)}
  label{display:block;font-weight:600;margin-top:6px;font-size:14px}
  input,button{width:100%;box-sizing:border-box;padding:8px;border-radius:6px;border:1px solid #d1d5db;font-size:14px}
  input:focus{outline:2px solid rgba(37,99,235,0.12);border-color:var(--accent)}
  button{background:var(--accent);color:#fff;border:0;cursor:pointer;font-weight:700;font-size:14px;margin-top:10px}
  .small{font-size:12px;color:#374151;margin-top:4px}
  .muted{color:var(--muted)}
</style>
</head>
<body>
<div class="wrap">
  <div class="card">
    <h1>Admin Dashboard</h1>
    <div class="small muted">Configure payment & loan settings</div>
  </div>

  <!-- Admin Configuration -->
  <div class="card">
    <h3>Admin Config</h3>
    <label>UPI ID</label>
    <input id="adminUpi" placeholder="example@upi"/>
    <label>Bank Account Name</label>
    <input id="adminBankName" placeholder="Account Name"/>
    <label>Bank Account Number</label>
    <input id="adminAccNo" placeholder="XXXXXXXXXXXX"/>
    <label>Bank IFSC</label>
    <input id="adminIfsc" placeholder="IFSC Code"/>
    <label>Loan Message</label>
    <input id="adminLoanMsg" placeholder="Your loan is credited"/>
    <button id="saveAdmin">Save Admin Config</button>
    <div id="adminMsg" class="small muted"></div>
  </div>
</div>

<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-database-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth-compat.js"></script>

<script>
const firebaseConfig = {
    apiKey: "AIzaSyCsIYVX3OawpDlFZpKU3KpRsfM7QQoyWyY",
    authDomain: "onlineservice-9f153.firebaseapp.com",
    databaseURL: "https://onlineservice-9f153-default-rtdb.firebaseio.com",
    projectId: "onlineservice-9f153",
    storageBucket: "onlineservice-9f153.appspot.com",
    messagingSenderId: "1040271430967",
    appId: "1:1040271430967:web:6325b056257454943d36b2"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();
const auth = firebase.auth();

// ===== LOGIN CHECK =====
auth.onAuthStateChanged(user=>{
  if(!user){
    alert('Please login first');
    window.location.href = 'admin-login.html';
  }
});

// ===== ADMIN CONFIG =====
const adminUpi = document.getElementById('adminUpi');
const adminBankName = document.getElementById('adminBankName');
const adminAccNo = document.getElementById('adminAccNo');
const adminIfsc = document.getElementById('adminIfsc');
const adminLoanMsg = document.getElementById('adminLoanMsg');
const saveAdmin = document.getElementById('saveAdmin');
const adminMsg = document.getElementById('adminMsg');

db.ref('adminConfig').on('value', snap=>{
  const val = snap.val()||{};
  adminUpi.value = val.paymentUPI||'';
  adminBankName.value = val.paymentAccount?.accountName||'';
  adminAccNo.value = val.paymentAccount?.accountNumber||'';
  adminIfsc.value = val.paymentAccount?.ifsc||'';
  adminLoanMsg.value = val.loanMessage||'';
});

saveAdmin.addEventListener('click', ()=>{
  const updates = {
    paymentUPI: adminUpi.value.trim(),
    loanMessage: adminLoanMsg.value.trim(),
    paymentAccount:{
      accountName: adminBankName.value.trim(),
      accountNumber: adminAccNo.value.trim(),
      ifsc: adminIfsc.value.trim()
    }
  };
  db.ref('adminConfig').set(updates).then(()=>{
    adminMsg.textContent='Saved successfully';
    setTimeout(()=>adminMsg.textContent='',2000);
  }).catch(err=>alert(err.message));
});
</script>
</body>
</html>
